2023-05-09T14:55:06.527Z app configuring middleware.
2023-05-09T14:55:07.424Z app configuring routes.
2023-05-09T14:55:07.451Z app configureServer(): Server started in mode undefined on port 9000.


Setting up test suite...
  (/accounts/categories) Account Categories
    ✔ GET /accounts/categories returns a list of account category
    ✔ GET /accounts/categories/:id returns one account category
    ✔ POST /accounts/categories adds an account category
    ✔ PUT /accounts/categories/:id updates the newly added account category
2023-05-09T14:55:07.695Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/index.js:127:17
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Expected record to contain a single record with id undefined, but 0 were found!'
}
    ✔ DELETE /accounts/categories/:id deletes a account type

  (/payroll/account_configuration) The /payroll/account_configuration  API endpoint
    ✔ GET /ACCOUNT_CONFIG returns a list of Account Configurations 
    ✔ POST /ACCOUNT_CONFIG should create a new Account Configuration
2023-05-09T14:55:07.716Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/index.js:127:17
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Expected record to contain a single record with id undefined, but 0 were found!'
}
    ✔ GET /ACCOUNT_CONFIG/:ID should not be found for unknown id
2023-05-09T14:55:07.755Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/index.js:127:17
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Expected record to contain a single record with id undefined, but 0 were found!'
}
    ✔ GET /ACCOUNT_CONFIG/:ID will send back a 404 if the Account Configuration is a string
    ✔ PUT /ACCOUNT_CONFIG  should update an existing Account Configuration
    ✔ GET /ACCOUNT_CONFIG/:ID returns a single Account Configuration
2023-05-09T14:55:07.792Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/index.js:278:17
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Could not find a Account Configuration with id 123456789'
}
    ✔ DELETE /ACCOUNT_CONFIG/:ID will send back a 404 if the Account Configuration does not exist
2023-05-09T14:55:07.795Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/index.js:284:17
    at _rejected (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:864:24)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:890:30
    at Promise.when (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:1142:31)
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:808:41)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Could not find a Account Configuration with id str'
}
    ✔ DELETE /ACCOUNT_CONFIG/:ID will send back a 404 if the Account Configuration is a string
    ✔ DELETE /ACCOUNT_CONFIG/:ID should delete an Account Configuration 

  (/account_reference_type) Account Reference Type
    ✔ GET /account_reference_type returns all Account Reference Type
    ✔ POST /account_reference_type add Account Reference Type
    ✔ GET /account_reference_type/:id returns one Account Reference Type as detail
    ✔ PUT /account_reference_type/:id updates the newly added Account Reference Type
2023-05-09T14:55:07.825Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/index.js:127:17
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Expected record to contain a single record with id undefined, but 0 were found!'
}
    ✔ DELETE /account_reference_type/:id deletes a Account Reference Type

  (/accounts/references) Accounts References
    ✔ POST /accounts/references adds a reference for a set of accounts
    ✔ GET /accounts/references/:id returns one accounts reference as detail
    ✔ GET /accounts/references/ with 'description' parameter
    ✔ GET /accounts/references/ with 'account' parameter
    ✔ GET /accounts/references/ with 'is_exception' parameter
    ✔ GET /accounts/references/ with 'reference_type_id' parameter
    ✔ PUT /accounts/references/:id updates the newly added account reference
    ✔ GET /accounts/references returns all accounts references
2023-05-09T14:55:07.888Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/index.js:127:17
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Expected record to contain a single record with id undefined, but 0 were found!'
}
    ✔ DELETE /accounts/references/:id deletes an accounts reference

  (/accounts/types) Account Types
    ✔ GET /accounts/types returns a list of account type
    ✔ GET /accounts/types/:id returns one account type
    ✔ POST /accounts/types adds an account type
    ✔ PUT /accounts/types/:id updates the newly added account type
2023-05-09T14:55:07.912Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/index.js:127:17
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Expected record to contain a single record with id undefined, but 0 were found!'
}
    ✔ DELETE /accounts/types/:id deletes a account type

  (/accounts) Accounts
    ✔ GET /accounts?detailed=1 returns the full list of account
    ✔ GET /accounts returns a simple list of account
    ✔ GET /accounts?locked=0 returns a list of unlocked accounts
    ✔ GET /accounts returns the accounts in sorted order by number
    ✔ GET /accounts/:id returns one account
2023-05-09T14:55:07.953Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/controllers/finance/accounts/utility.js:33:15
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Could not find account with id unknown.'
}
    ✔ GET /accounts/:id returns a 404 error for unknown id
    ✔ GET /accounts/:id/balance returns an object with zero as balance, debit and credit
    ✔ GET /accounts/:id/balance?journal=1 returns the balance of a provided account_id, scans the journal also
    ✔ POST /accounts a adds an account
    ✔ PUT /accounts/:id updates the newly added account
    ✔ PUT /accounts/:id updates the account cost center
2023-05-09T14:55:07.983Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/controllers/finance/accounts/utility.js:33:15
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Could not find account with id undefined.'
}
    ✔ PUT /accounts/:id returns a 404 for unknown account id
    ✔ DELETE /accounts/:id deletes the newly added account
2023-05-09T14:55:07.993Z errors #interceptor() BadRequest [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/controllers/finance/accounts/index.js:125:15
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 400,
  code: 'ERRORS.BAD_REQUEST',
  description: '\n' +
    '          Could not delete account with id: 117. This account contains child accounts.\n' +
    '        '
}
    ✔ DELETE /accounts/:id prevents the deletion of accounts with children
    ✔ GET /accounts?hidden=1 returns one hidden account
    ✔ GET /accounts?hidden=0 returns all but one hidden account
    ✔ GET /accounts/:id/cost-center will retrieve a cost center by account id

  (/cost_center_allocation) The /cost_center  API endpoint
    ✔ GET /allocation_cost_center  
    ✔ POST /allocation_cost_center/allocationKey a new Distribution Cost Center Key: 1
    ✔ POST /allocation_cost_center/allocationKey a new allocation cost center key: 2
    ✔ POST /allocation_cost_center/proceed allocation of aux cost centers to main centers by currency
2023-05-09T14:55:08.049Z errors #interceptor() BadRequest [Error]
    at proceed (/Users/brucembayo/IMA/bhima/bin/server/controllers/finance/allocationCostCenter/proceed.js:64:11)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/route.js:144:13)
    at Route.dispatch (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/route.js:114:3)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:284:15
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at logger (/Users/brucembayo/IMA/bhima/node_modules/morgan/index.js:144:5)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:328:13)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at /Users/brucembayo/IMA/bhima/bin/server/config/access.js:47:5
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:328:13)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at serveStatic (/Users/brucembayo/IMA/bhima/node_modules/serve-static/index.js:75:16)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:328:13)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at /Users/brucembayo/IMA/bhima/node_modules/express-session/index.js:506:7
    at /Users/brucembayo/IMA/bhima/node_modules/connect-redis/lib/connect-redis.js:43:16
    at tryCatcher (/Users/brucembayo/IMA/bhima/node_modules/standard-as-callback/built/utils.js:12:23)
    at /Users/brucembayo/IMA/bhima/node_modules/standard-as-callback/built/index.js:22:53
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {
  status: 400,
  code: 'ERRORS.BAD_REQUEST',
  description: 'ERRORS.ER_EMPTY_QUERY'
}
    ✔ POST /allocation_cost_center/proceed throws BadRequest if dataToDistribute.length is 0
    ✔ /allocation_cost_center/automatic Automatically distributes invoices with referenced services to main expense centers
    ✔ GET /allocation_cost_center/getDistributed retunrs all allocations of costs and profits made manually
    ✔ GET /allocation_cost_center/getDistributionKey Obtaining the list of all defined allocation keys
    ✔ POST /allocation_cost_center/resetKey : Reset the allocation keys

  (/barcode) Barcode Reverse Lookup
    ✔ /barcode/:key looks up patient for valid barcode key PA81af634f
    ✔ /barcode/:key looks up a barcode for a lot LT064ab1d9
2023-05-09T14:55:08.151Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/index.js:127:17
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Expected record to contain a single record with id undefined, but 0 were found!'
}
    ✔ /barcode/invalid returns 404 for valid PA document type, invalid UUID
2023-05-09T14:55:08.154Z errors #interceptor() BadRequest [Error]
    at Object.reverseLookup (/Users/brucembayo/IMA/bhima/bin/server/lib/barcode.js:50:11)
    at barcodeLookup (/Users/brucembayo/IMA/bhima/bin/server/controllers/report.js:237:11)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/route.js:144:13)
    at Route.dispatch (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/route.js:114:3)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:284:15
    at param (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:365:14)
    at param (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:376:14)
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:421:3)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at logger (/Users/brucembayo/IMA/bhima/node_modules/morgan/index.js:144:5)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:328:13)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at /Users/brucembayo/IMA/bhima/bin/server/config/access.js:47:5
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:328:13)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at SendStream.error (/Users/brucembayo/IMA/bhima/node_modules/serve-static/index.js:121:7)
    at SendStream.emit (node:events:513:28)
    at SendStream.error (/Users/brucembayo/IMA/bhima/node_modules/send/index.js:270:17)
    at SendStream.onStatError (/Users/brucembayo/IMA/bhima/node_modules/send/index.js:417:12)
    at next (/Users/brucembayo/IMA/bhima/node_modules/send/index.js:731:16)
    at onstat (/Users/brucembayo/IMA/bhima/node_modules/send/index.js:720:14)
    at FSReqCallback.oncomplete (node:fs:211:21) {
  status: 400,
  code: 'ERRORS.BAD_REQUEST',
  description: "Invalid barcode document type 'ZZ'"
}
    ✔ /barcode/invalid returns 400 for an invalid barcode document code

  (/cash) Cash Payments
2023-05-09T14:55:08.159Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/controllers/finance/cash.js:80:15
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'No cash record by uuid: undefined'
}
    ✔ GET /cash/undefined returns an error
    ✔ GET /cash returns the expected number of payments
2023-05-09T14:55:08.204Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/controllers/finance/cash.js:80:15
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'No cash record by uuid: 25b69e1d-c9bc-46f2-98a5-5dd948de3636'
}
    ✔ DELETE /transactions/:uuid deletes a cash payment (41ms)
    Caution Payments 
      ✔ POST /cash should create a caution payment (43ms)
    Patient Invoice Payments 
      ✔ POST /cash should create a cash payment against multiple invoices (45ms)
2023-05-09T14:55:08.297Z errors #interceptor() BadRequest [Error]
    at create (/Users/brucembayo/IMA/bhima/bin/server/controllers/finance/cash.create.js:84:10)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/route.js:144:13)
    at Route.dispatch (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/route.js:114:3)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:284:15
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at logger (/Users/brucembayo/IMA/bhima/node_modules/morgan/index.js:144:5)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:328:13)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at /Users/brucembayo/IMA/bhima/bin/server/config/access.js:47:5
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:328:13)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at serveStatic (/Users/brucembayo/IMA/bhima/node_modules/serve-static/index.js:75:16)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:328:13)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at /Users/brucembayo/IMA/bhima/node_modules/express-session/index.js:506:7
    at /Users/brucembayo/IMA/bhima/node_modules/connect-redis/lib/connect-redis.js:43:16
    at tryCatcher (/Users/brucembayo/IMA/bhima/node_modules/standard-as-callback/built/utils.js:12:23)
    at /Users/brucembayo/IMA/bhima/node_modules/standard-as-callback/built/index.js:22:53
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {
  status: 400,
  code: 'ERRORS.BAD_REQUEST',
  description: 'You must submit cash items with the payments against previous invoices.'
}
      ✔ POST /cash should not create a cash payment if cash items are empty
      ✔ PUT /cash/:uuid should update editable fields on a previous cash payment (43ms)
2023-05-09T14:55:08.358Z errors #interceptor() BadRequest [Error]
    at update (/Users/brucembayo/IMA/bhima/bin/server/controllers/finance/cash.js:223:11)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/route.js:144:13)
    at Route.dispatch (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/route.js:114:3)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:284:15
    at param (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:365:14)
    at param (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:376:14)
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:421:3)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at logger (/Users/brucembayo/IMA/bhima/node_modules/morgan/index.js:144:5)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:328:13)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at /Users/brucembayo/IMA/bhima/bin/server/config/access.js:47:5
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:328:13)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at serveStatic (/Users/brucembayo/IMA/bhima/node_modules/serve-static/index.js:75:16)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:328:13)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at /Users/brucembayo/IMA/bhima/node_modules/express-session/index.js:506:7
    at /Users/brucembayo/IMA/bhima/node_modules/connect-redis/lib/connect-redis.js:43:16
    at tryCatcher (/Users/brucembayo/IMA/bhima/node_modules/standard-as-callback/built/utils.js:12:23)
    at /Users/brucembayo/IMA/bhima/node_modules/standard-as-callback/built/index.js:22:53
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {
  status: 400,
  code: 'ERRORS.PROTECTED_FIELD',
  description: 'The update request attempted to change a protected field.'
}
      ✔ PUT /cash/:uuid should not update non-editable fields on a previous cash payment
      ✔ GET /cash/:uuid should return the full payment details of a cash payment
2023-05-09T14:55:08.372Z errors #interceptor() BadRequest [Error]
    at create (/Users/brucembayo/IMA/bhima/bin/server/controllers/finance/cash.create.js:92:10)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/route.js:144:13)
    at Route.dispatch (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/route.js:114:3)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:284:15
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at logger (/Users/brucembayo/IMA/bhima/node_modules/morgan/index.js:144:5)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:328:13)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at /Users/brucembayo/IMA/bhima/bin/server/config/access.js:47:5
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:328:13)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at serveStatic (/Users/brucembayo/IMA/bhima/node_modules/serve-static/index.js:75:16)
    at Layer.handle [as handle_request] (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:328:13)
    at /Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/brucembayo/IMA/bhima/node_modules/express/lib/router/index.js:280:10)
    at /Users/brucembayo/IMA/bhima/node_modules/express-session/index.js:506:7
    at /Users/brucembayo/IMA/bhima/node_modules/connect-redis/lib/connect-redis.js:43:16
    at tryCatcher (/Users/brucembayo/IMA/bhima/node_modules/standard-as-callback/built/utils.js:12:23)
    at /Users/brucembayo/IMA/bhima/node_modules/standard-as-callback/built/index.js:22:53
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {
  status: 400,
  code: 'ERRORS.BAD_REQUEST',
  description: 'You must be confused. You submitted payment against items marked as a\n' +
    '        caution payment.  Please submit either a caution with no items or a payment\n' +
    '        marked with is_caution = 0.'
}
      ✔ POST /cash should not process cash_items if is_caution flag is set
      ✔ GET /cash/:checkin should found one invoice paid
      ✔ GET /cash/:checkin sould found zero invoice paid
    (/search) Search
      ✔ GET /cash without parameters returns all cash payments
      ✔ GET /cash filters by description and returns one record
      ✔ GET /cash?limit=1 returns a single record
      ✔ GET /cash?is_caution=1 returns one record
      ✔ GET /cash?is_caution=0 returns two records
      ✔ GET /cash?debtor_uuid=? returns 3 records
      ✔ GET /cash?debtor_uuid=?&limit=1 should combine to return a single record
      ✔ GET /cash?cashbox_id=2 should return one record
      ✔ GET /cash?reference=CP.TPA.1 should return a single record
      ✔ GET /cash?dateFrom=2016-01-01 should return all records
      ✔ GET /cash?dateFrom=2016-01-01&dateTo=2023-05-10 should return all records
      ✔ GET /cash?user_id=1 should return all records
      ✔ GET /cash?currency_id=1 should return all records

  (/cashboxes) The Cashboxes API endpoint
    ✔ GET /cashboxes returns a list of cashboxes
    ✔ GET /cashboxes?is_auxiliary=1 returns only auxiliary cashboxes
    ✔ GET /cashboxes?detailed=1 returns a list of cashboxes with expanded properties
    ✔ GET /cashboxes/:id should return a single cashbox with currencies
2023-05-09T14:55:08.503Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/index.js:127:17
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Expected Cashbox to contain a single record with id invalid, but 0 were found!'
}
    ✔ GET /cashboxes/:id should return a 404 for invalid cashbox
    ✔ POST /cashboxes should create a new cashbox
    ✔ PUT /cashboxes/:id should update the cashbox
    ✔ GET /cashboxes/:id/currencies should return an empty list of cashbox currencies
    ✔ POST /cashboxes/:id/currencies should create a new currency account
    ✔ GET /cashboxes/:id/currencies/:currencyId should return a single cashbox currency reference
2023-05-09T14:55:08.538Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/controllers/finance/cashboxes/currencies.js:57:15
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: '\n' +
    '          Could not find a cash box account currency with id unknown.\n' +
    '        '
}
    ✔ GET /cashboxes/:id/currencies/unknown should return a single cashbox currency reference
    ✔ PUT /cashboxes/:id/currencies/:currencyId should update a new currency account
    ✔ PUT /cashboxes/:id/currencies/<undefined currency> should successfully return nothing
    ✔ PUT /cashboxes/:id/currencies/<invalid value> should successfully return nothing
    ✔ GET /cashboxes/:id/users should return users subscribed to a cashbox
2023-05-09T14:55:08.582Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/index.js:127:17
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Expected Cashbox to contain a single record with id 3, but 0 were found!'
}
    ✔ DELETE /cashboxes/:id should delete the cashbox and associated currencies
2023-05-09T14:55:08.588Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/index.js:278:17
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Could not find a cash box with id 123456789'
}
    ✔ DELETE /cashboxes/:id should return a 404 for an unknown cashbox id
2023-05-09T14:55:08.591Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/index.js:284:17
    at _rejected (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:864:24)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:890:30
    at Promise.when (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:1142:31)
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:808:41)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Could not find a cash box with id str'
}
    ✔ DELETE /cashboxes/:id should return a 404 it the cashbox id is a string
    ✔ GET /cashboxes privileges for the current User On Each Auxiliary Cashboxes

  (/choices_list_management) Choice List Management
    ✔ POST /choises_list_management add Choice List Element
    ✔ GET /choices_list_management/:id returns one Choice List Management as detail
    ✔ PUT /choices_list_management/:id updates the newly added Choice List Management
    ✔ GET /choices_list_management returns all Choice List Management
2023-05-09T14:55:08.634Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/index.js:127:17
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Expected record to contain a single record with id undefined, but 0 were found!'
}
    ✔ DELETE /choices_list_management/:id deletes a Choice List Management

  (/configuration_analysis_tools) Configuration Analysis Tools
    ✔ POST /configuration_analysis_tools add new Configuration
    ✔ GET /configuration_analysis_tools all Analysis Configuration
    ✔ GET /configuration_analysis_tools/:id returns one Configuration as detail
    ✔ PUT /configuration_analysis_tools/:id updates the newly added Configuration
2023-05-09T14:55:08.658Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/index.js:127:17
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Expected record to contain a single record with id undefined, but 0 were found!'
}
    ✔ DELETE /configuration_analysis_tools/:id deletes a Analysis Configuration element

  (/cost_center) The /cost_center  API endpoint
    ✔ GET /cost_center returns a list of Fees Centers
    ✔ POST /cost_center should create a new Cost Center
    ✔ GET /cost_center/:ID result should be empty for an unknown id
    ✔ GET /cost_center/:ID result should be empty if the cost center id is a string
    ✔ GET /cost_center/:ID result should be empty when the id is a string
    ✔ PUT /cost_center/:ID should update the Label for an existing Cost Center 
2023-05-09T14:55:08.714Z errors #interceptor() Error: ER_DUP_ENTRY: Duplicate entry '8' for key 'reference_cost_center.reference_cost_center_1'
    at Sequence._packetToError (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/sequences/Sequence.js:47:14)
    at Query.ErrorPacket (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/sequences/Query.js:79:18)
    at Protocol._parsePacket (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/Protocol.js:291:23)
    at Parser._parsePacket (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/Parser.js:433:10)
    at Parser.write (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/Parser.js:43:10)
    at Protocol.write (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/Protocol.js:38:16)
    at Socket.<anonymous> (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/Connection.js:88:28)
    at Socket.<anonymous> (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/Connection.js:526:10)
    at Socket.emit (node:events:513:28)
    at addChunk (node:internal/streams/readable:324:12)
    at readableAddChunk (node:internal/streams/readable:297:9)
    at Readable.push (node:internal/streams/readable:234:10)
    at TCP.onStreamRead (node:internal/stream_base_commons:190:23)
    --------------------
    at Protocol._enqueue (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/Protocol.js:144:48)
    at PoolConnection.query (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/Connection.js:198:25)
    at queryConnection (/Users/brucembayo/IMA/bhima/bin/server/lib/db/transaction.js:14:28)
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/transaction.js:127:48
    at Array.map (<anonymous>)
    at Query.<anonymous> (/Users/brucembayo/IMA/bhima/bin/server/lib/db/transaction.js:127:34)
    at Query.<anonymous> (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/Connection.js:526:10)
    at Query._callback (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/Connection.js:488:16)
    at Sequence.end (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/sequences/Sequence.js:83:24)
    at Query._handleFinalResultPacket (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/sequences/Query.js:149:8)
    at Query.OkPacket (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/sequences/Query.js:74:10)
    at Protocol._parsePacket (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/Protocol.js:291:23)
    at Parser._parsePacket (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/Parser.js:433:10)
    at Parser.write (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/Parser.js:43:10)
    at Protocol.write (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/Protocol.js:38:16)
    at Socket.<anonymous> (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/Connection.js:88:28)
    at Socket.<anonymous> (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/Connection.js:526:10)
    at Socket.emit (node:events:513:28)
    at addChunk (node:internal/streams/readable:324:12)
    at readableAddChunk (node:internal/streams/readable:297:9)
    at Readable.push (node:internal/streams/readable:234:10)
    at TCP.onStreamRead (node:internal/stream_base_commons:190:23) {
  code: 'ER_DUP_ENTRY',
  errno: 1062,
  sqlMessage: "Duplicate entry '8' for key 'reference_cost_center.reference_cost_center_1'",
  sqlState: '23000',
  index: 0,
  sql: '\n' +
    '      INSERT INTO reference_cost_center\n' +
    "      (cost_center_id, account_reference_id, is_cost, is_variable, is_turnover) VALUES ('4321', 8, 0, NULL, NULL)"
}
    ✔ PUT /cost_center/:ID should return 400 for an non-existing Cost Center 
2023-05-09T14:55:08.720Z errors #interceptor() Error: ER_TRUNCATED_WRONG_VALUE: Truncated incorrect DOUBLE value: 'str'
    at Sequence._packetToError (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/sequences/Sequence.js:47:14)
    at Query.ErrorPacket (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/sequences/Query.js:79:18)
    at Protocol._parsePacket (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/Protocol.js:291:23)
    at Parser._parsePacket (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/Parser.js:433:10)
    at Parser.write (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/Parser.js:43:10)
    at Protocol.write (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/Protocol.js:38:16)
    at Socket.<anonymous> (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/Connection.js:88:28)
    at Socket.<anonymous> (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/Connection.js:526:10)
    at Socket.emit (node:events:513:28)
    at addChunk (node:internal/streams/readable:324:12)
    at readableAddChunk (node:internal/streams/readable:297:9)
    at Readable.push (node:internal/streams/readable:234:10)
    at TCP.onStreamRead (node:internal/stream_base_commons:190:23)
    --------------------
    at Protocol._enqueue (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/Protocol.js:144:48)
    at PoolConnection.query (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/Connection.js:198:25)
    at queryConnection (/Users/brucembayo/IMA/bhima/bin/server/lib/db/transaction.js:14:28)
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/transaction.js:127:48
    at Array.map (<anonymous>)
    at Query.<anonymous> (/Users/brucembayo/IMA/bhima/bin/server/lib/db/transaction.js:127:34)
    at Query.<anonymous> (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/Connection.js:526:10)
    at Query._callback (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/Connection.js:488:16)
    at Sequence.end (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/sequences/Sequence.js:83:24)
    at Query._handleFinalResultPacket (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/sequences/Query.js:149:8)
    at Query.OkPacket (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/sequences/Query.js:74:10)
    at Protocol._parsePacket (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/Protocol.js:291:23)
    at Parser._parsePacket (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/Parser.js:433:10)
    at Parser.write (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/Parser.js:43:10)
    at Protocol.write (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/protocol/Protocol.js:38:16)
    at Socket.<anonymous> (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/Connection.js:88:28)
    at Socket.<anonymous> (/Users/brucembayo/IMA/bhima/node_modules/mysql/lib/Connection.js:526:10)
    at Socket.emit (node:events:513:28)
    at addChunk (node:internal/streams/readable:324:12)
    at readableAddChunk (node:internal/streams/readable:297:9)
    at Readable.push (node:internal/streams/readable:234:10)
    at TCP.onStreamRead (node:internal/stream_base_commons:190:23) {
  code: 'ER_TRUNCATED_WRONG_VALUE',
  errno: 1292,
  sqlMessage: "Truncated incorrect DOUBLE value: 'str'",
  sqlState: '22007',
  index: 0,
  sql: "UPDATE cost_center SET `label` = 'Update Test', `is_principal` = 0, `project_id` = NULL, `allocation_method` = 'proportional', `allocation_basis_id` = 3 WHERE id = 'str';"
}
    ✔ PUT /cost_center should return 400 if the Cost Center id is a string 
    ✔ PUT /cost_center  should update Cost Center Type, Reference fee Center for an existing Cost Center 
    ✔ DELETE /cost_center/:id should delete a Cost Center
2023-05-09T14:55:08.737Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/controllers/finance/cost_center.js:269:15
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Could not find a Cost Center with id 404.'
}
    ✔ DELETE /cost_center/:id should return 404 for an unknown cost center

  (/cost_center_allocation_basis) The cost center step-down allocation basis API endpoint
    ✔ GET /cost_center_allocation_basis returns a list of allocation basis items
    ✔ POST /cost_center_allocation_basis should create a new allocation basis item
    ✔ Verify that we added a new allocation basis item
2023-05-09T14:55:08.745Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/index.js:127:17
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Expected record to contain a single record with id undefined, but 0 were found!'
}
    ✔ GET /cost_center_allocation_basis/:ID result should be empty for an unknown id
    ✔ PUT /cost_center_allocation_basis/:ID should update the existing allocation basis item
    ✔ GET /cost_center_allocation_basis/:ID get the newly updated allocation basis item
    ✔ DELETE /cost_center_allocation_basis/:id should delete an allocation basis item
    ✔ Verify that we have the same number allocation basis items as when we started

  /cost_center_allocation_basis_quantity Cost center step-down allocation basis quantity API endpoint
    ✔ GET /cost_center_allocation_basis_quantity returns a list of allocation basis quantity items
    ✔ POST /cost_center_allocation_basis_quantity should create a new allocation basis quantity item
    ✔ Verify that we added a new allocation basis quantity item
    ✔ Add a second allocation basis quantity item
    ✔ Verify that we added a new allocation basis quantity item
    ✔ Get an allocation basis quantity item by basis_id
    ✔ Get an allocation basis quantity item by cost_center_id
    ✔ Get an allocation basis quantity item by basis_id and cost_center_id
    ✔ PUT /cost_center_allocation_basis_quantity/:id should update the existing allocation basis quantity item
    ✔ Verify the update for the allocation basis quantity item
    ✔ DELETE /cost_center_allocation_basis_quantity/:id should delete an allocation basis item
    ✔ Verify that we have deleted one allocation basis quantity item
    ✔ DELETE /cost_center_allocation_basis_quantity/:id should delete the last allocation basis item
    ✔ Verify that we have deleted all allocation basis quantity items

  (/creditors/groups) Creditor Groups
    ✔ GET /creditors/groups returns a list of creditor group
    ✔ POST /creditors/groups  should create a new creditor group
2023-05-09T14:55:08.811Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/index.js:127:17
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Expected Creditor Group to contain a single record with id 123456789, but 0 were found!'
}
    ✔ GET /creditors/groups/:uuid should not be found for unknown uuid
2023-05-09T14:55:08.814Z errors #interceptor() NotFound [Error]
    at /Users/brucembayo/IMA/bhima/bin/server/lib/db/index.js:127:17
    at _fulfilled (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:854:54)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:883:30
    at Promise.promise.promiseDispatch (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:816:13)
    at /Users/brucembayo/IMA/bhima/node_modules/q/q.js:624:44
    at runSingle (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:137:13)
    at flush (/Users/brucembayo/IMA/bhima/node_modules/q/q.js:125:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
  status: 404,
  code: 'ERRORS.NOT_FOUND',
  description: 'Expected Creditor Group to contain a single record with id str, but 0 were found!'
}
    ✔ GET /creditors/groups/:uuid should not be found for invalid uuid
    ✔ PUT /creditors/groups  should update an existing creditor group
    ✔ GET /creditors/groups/:uuid returns a single creditor group

  (/cron_email_reports) The cron_email_reports API 
2023-05-09T14:55:08.825Z errors #interceptor() TypeError: job.nextDate(...).toFormat is not a function
    at addJob (/Users/brucembayo/IMA/bhima/bin/server/controllers/admin/cronEmailReport/index.js:147:38)
    at createEmailReportJob (/Users/brucembayo/IMA/bhima/bin/server/controllers/admin/cronEmailReport/index.js:181:15)
    at create (/Users/brucembayo/IMA/bhima/bin/server/controllers/admin/cronEmailReport/index.js:120:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    1) POST /cron_email_reports create a new cron_email_report in the database

Test suite completed.

  156 passing (1s)
  1 failing

  1) (/cron_email_reports) The cron_email_reports API 
       POST /cron_email_reports create a new cron_email_report in the database:

      AssertionError: expected { Object (_events, _eventsCount, ...) } to have status code 201 but got 500
      + expected - actual

      -500
      +201
      
      at Object.created (test/integration/helpers.js:59:23)
      at /Users/brucembayo/IMA/bhima/test/integration/cronEmailReport/cronEmailReport.js:31:21
      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)



